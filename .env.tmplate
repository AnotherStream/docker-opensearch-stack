# OpenSearch Stack Environment Configuration for Windows
# Windows環境用設定ファイル

# ==================================================
# 基本設定
# ==================================================

# クラスター名
OPENSEARCH_CLUSTER_NAME=opensearch-cluster

# Javaヒープサイズ設定
OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m
LOGSTASH_JAVA_OPTS=-Xmx256m -Xms256m

# ==================================================
# ポート設定
# ==================================================

# OpenSearch REST API
OPENSEARCH_REST_PORT=9200

# OpenSearch Performance Analyzer
OPENSEARCH_PERF_PORT=9600

# OpenSearch Dashboards Web UI
OPENSEARCH_DASHBOARDS_PORT=5601

# Logstash入力ポート
LOGSTASH_BEATS_PORT=5044
LOGSTASH_TCP_PORT=5000
LOGSTASH_MONITORING_PORT=9600

# ==================================================
# セキュリティ設定（開発環境用）
# ==================================================

# セキュリティプラグインを無効化（開発・テスト環境用）
DISABLE_SECURITY_PLUGIN=true
DISABLE_SECURITY_DASHBOARDS_PLUGIN=true

# デモ設定を無効化
DISABLE_INSTALL_DEMO_CONFIG=true

# ==================================================
# デバッグ・ログ設定
# ==================================================

# Logstash標準出力デバッグ
LOGSTASH_STDOUT_DEBUG=true

# Filebeatログレベル
FILEBEAT_LOG_LEVEL=info

# OpenSearchログレベル
OPENSEARCH_LOG_LEVEL=info

# ==================================================
# パス設定（Windows用）
# ==================================================

# ベースボリュームパス
VOLUMES_ROOT=.\Volumes

# OpenSearchデータパス
OPENSEARCH_NODE1_DATA_PATH=%VOLUMES_ROOT%\OpenSearch\Node1\usr\share\opensearch\data
OPENSEARCH_NODE2_DATA_PATH=%VOLUMES_ROOT%\OpenSearch\Node2\usr\share\opensearch\data

# OpenSearch Dashboards設定・データパス
DASHBOARDS_CONFIG_PATH=%VOLUMES_ROOT%\OpenSearchDashboards\usr\share\opensearch-dashboards\config
DASHBOARDS_DATA_PATH=%VOLUMES_ROOT%\OpenSearchDashboards\usr\share\opensearch-dashboards\data

# Logstash設定・データパス
LOGSTASH_CONFIG_PATH=%VOLUMES_ROOT%\Logstash\usr\share\logstash\config
LOGSTASH_PIPELINE_PATH=%VOLUMES_ROOT%\Logstash\usr\share\logstash\pipeline

# Filebeat設定・ログパス
FILEBEAT_CONFIG_PATH=%VOLUMES_ROOT%\Filebeat\usr\share\filebeat
FILEBEAT_LOG_PATH=%VOLUMES_ROOT%\Filebeat\var\log\app
FILEBEAT_DOCKER_CONTAINERS_PATH=%VOLUMES_ROOT%\Filebeat\var\lib\docker\containers
FILEBEAT_DOCKER_SOCK_PATH=%VOLUMES_ROOT%\Filebeat\var\run\docker.sock

# ==================================================
# ネットワーク設定
# ==================================================

# Dockerネットワーク名
OPENSEARCH_NETWORK=opensearch-net

# OpenSearchクラスター設定
OPENSEARCH_DISCOVERY_SEED_HOSTS=opensearch-node1,opensearch-node2
OPENSEARCH_CLUSTER_INITIAL_MASTER_NODES=opensearch-node1,opensearch-node2

# ==================================================
# パフォーマンス設定
# ==================================================

# Logstashパイプライン設定
OPENSEARCH_PIPELINE_WORKERS=2
OPENSEARCH_PIPELINE_BATCH_SIZE=125
OPENSEARCH_PIPELINE_BATCH_DELAY=50

# メモリロック設定
OPENSEARCH_BOOTSTRAP_MEMORY_LOCK=true

# ファイルディスクリプタ制限
OPENSEARCH_NOFILE_SOFT=65536
OPENSEARCH_NOFILE_HARD=65536

# メモリロック制限
OPENSEARCH_MEMLOCK_SOFT=-1
OPENSEARCH_MEMLOCK_HARD=-1

# ==================================================
# 開発環境用設定
# ==================================================

# インデックス設定
OPENSEARCH_DEFAULT_SHARDS=1
OPENSEARCH_DEFAULT_REPLICAS=1

# リフレッシュ間隔
OPENSEARCH_REFRESH_INTERVAL=1s

# ==================================================
# Windows固有設定
# ==================================================

# WSL2メモリ制限（参考値）
# %USERPROFILE%\.wslconfig ファイルで設定
# [wsl2]
# memory=8GB
# processors=4
# swap=2GB

# Docker Desktop推奨設定（参考値）
# Memory: 6GB以上
# CPUs: 2以上
# Disk image size: 60GB以上

# ==================================================
# 環境別設定例
# ==================================================

# 開発環境用（デフォルト）
# OPENSEARCH_JAVA_OPTS=-Xms512m -Xmx512m
# LOGSTASH_JAVA_OPTS=-Xmx256m -Xms256m
# DISABLE_SECURITY_PLUGIN=true

# ステージング環境用
# OPENSEARCH_JAVA_OPTS=-Xms1g -Xmx1g
# LOGSTASH_JAVA_OPTS=-Xmx512m -Xms512m
# LOGSTASH_STDOUT_DEBUG=false

# 本番環境用
# OPENSEARCH_JAVA_OPTS=-Xms4g -Xmx4g
# LOGSTASH_JAVA_OPTS=-Xmx2g -Xms2g
# DISABLE_SECURITY_PLUGIN=false
# LOGSTASH_STDOUT_DEBUG=false
# FILEBEAT_LOG_LEVEL=error

# ==================================================
# 追加設定（オプション）
# ==================================================

# タイムゾーン設定
TZ=Asia/Tokyo

# 言語・ロケール設定
LANG=ja_JP.UTF-8
LC_ALL=ja_JP.UTF-8

# ホスト名設定
OPENSEARCH_NODE1_HOST=opensearch-node1
OPENSEARCH_NODE2_HOST=opensearch-node2
DASHBOARDS_HOST=opensearch-dashboards
LOGSTASH_HOST=logstash
FILEBEAT_HOST=filebeat

# 接続タイムアウト設定
OPENSEARCH_CLIENT_TIMEOUT=60s
LOGSTASH_CLIENT_TIMEOUT=60s

# バックアップ設定
BACKUP_ENABLED=false
BACKUP_SCHEDULE="0 2 * * *"
BACKUP_RETENTION_DAYS=7

# モニタリング設定
MONITORING_ENABLED=true
HEALTH_CHECK_INTERVAL=30s

# アラート設定
ALERT_EMAIL_ENABLED=false
ALERT_EMAIL_SMTP_HOST=localhost
ALERT_EMAIL_SMTP_PORT=587
ALERT_EMAIL_FROM=noreply@example.com
ALERT_EMAIL_TO=admin@example.com